"use strict";(self.webpackChunkcli=self.webpackChunkcli||[]).push([[493],{6713:function(t,e,n){n.d(e,{Fr:function(){return d},ZP:function(){return u},gy:function(){return f},kD:function(){return h}});var s=n(4165),o=n(5861),r=n(4569),i=n.n(r);function u(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"allowed";return new Promise((function(u){var c={method:e,url:"https://service-forum.herokuapp.com/"+t,data:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:l(r)}};i()(c).then((function(t){return a(t,u)})).catch(function(){var t=(0,o.Z)((0,s.Z)().mark((function t(e){var n;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.response||401!==e.response.status){t.next=4;break}return n={status:"login",data:null},console.log(n),t.abrupt("return",u(n));case 4:u({status:"error",data:e});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))}function a(t,e){return c.apply(this,arguments)}function c(){return(c=(0,o.Z)((0,s.Z)().mark((function t(e,n){var o,r;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(e),!(e.status<200||e.status>=300)){t.next=4;break}return o={status:"error",data:e.data},t.abrupt("return",n(o));case 4:return r={status:"ok",data:e.data},t.abrupt("return",n(r));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function l(t){return"Bearer "+localStorage.getItem("token_"+t)}function h(t){return!!localStorage.getItem("token_"+t)}function d(t,e){localStorage.setItem("token_"+t,e)}function f(t){localStorage.removeItem("token_"+t)}},9493:function(t,e,n){n.r(e),n.d(e,{default:function(){return y}});var s=n(4942);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){(0,s.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}for(var i=n(5671),u=n(3144),a=n(7326),c=n(136),l=n(8557),h=n(2791),d=n(8695),f=n(7022),p=n(6149),m=n(2677),x=n(3360),g=n(1523),j=n(6713),v=n(3847),Z=n(184),w=[],b=0;b<5;b++)w.push((0,Z.jsxs)("div",{children:[(0,Z.jsxs)(d.Z,{children:[(0,Z.jsxs)(d.Z.Body,{children:[(0,Z.jsx)(d.Z.Title,{children:(0,Z.jsx)("p",{})}),(0,Z.jsx)(d.Z.Text,{children:(0,Z.jsx)("br",{})})]}),(0,Z.jsx)(d.Z.Footer,{children:(0,Z.jsx)(d.Z.Text,{children:(0,Z.jsx)("br",{})})})]},b),(0,Z.jsx)("br",{}),(0,Z.jsx)("br",{})]}));var y=function(t){(0,c.Z)(n,t);var e=(0,l.Z)(n);function n(t){var s;return(0,i.Z)(this,n),(s=e.call(this,t)).getAllQuotes=function(){(0,j.ZP)("api/post","get",{}).then((function(t){if(console.log("response",t),"error"!==t.status)if("login"===t.status&&s.setLogginState(!1),Array.isArray(t.data)){var e=t.data;s.setQuotesState(e)}else s.setQuotesState([])})).catch((function(t){return console.log(t)}))},s.setQuotesState=function(t){s.setState(Object.assign(s.state,{quotes:t}))},s.state={newQuote:{author:"",body:""},isLoggedIn:!0,quotes:[],quotesComment:new Map},s.setNewQuote=s.setNewQuote.bind((0,a.Z)(s)),s.postQuote=s.postQuote.bind((0,a.Z)(s)),s}return(0,u.Z)(n,[{key:"componentDidMount",value:function(){var t=this;this.getAllQuotes(),new BroadcastChannel("sync-channel").onmessage=function(e){e.data.finished&&t.getAllQuotes()}}},{key:"postQuote",value:function(t){var e=this;t.preventDefault(),(0,j.ZP)("api/post/create","post",r({},this.state.newQuote)).then((function(t){console.log(t),"ok"===t.status&&e.getAllQuotes()})).catch((function(t){return console.log(t)}))}},{key:"postQuoteComment",value:function(t,e){e.preventDefault(),this.state.quotesComment.has(t)&&(0,j.ZP)("api/post/".concat(t,"/comment"),"post",{text:this.state.quotesComment.get(t)}).then((function(e){(0,j.ZP)("api/post/"+t,"get",{}).then((function(t){return console.log(t)})).catch((function(t){return console.log(t)})),console.log("returned comment from api",e)})).catch((function(t){return console.log(t)}))}},{key:"setLogginState",value:function(t){var e=Object.assign(this.state,{isLoggedIn:t});this.setState(e)}},{key:"setNewQuote",value:function(t){this.setState((function(e){return r(r({},e),{},{newQuote:r(r({},e.newQuote),{},(0,s.Z)({},t.target.id,t.target.value))})}))}},{key:"setQuoteComment",value:function(t,e){this.setState((function(n){return r(r({},n),{},{quotesComment:n.quotesComment.set(t,e.target.value)})}))}},{key:"getIniitalComment",value:function(t){return this.state.quotesComment.has(t)?this.state.quotesComment.get(t):""}},{key:"render",value:function(){var t=this;if(!1===this.state.isLoggedIn)return(0,Z.jsxs)(f.Z,{children:[(0,Z.jsx)("br",{}),(0,Z.jsxs)(d.Z.Text,{children:[(0,Z.jsx)("h3",{children:"You are not signed in!"}),(0,Z.jsxs)("p",{children:["Please, go back and ",(0,Z.jsx)("span",{children:"\ud83d\udc49 "}),(0,Z.jsx)(g.rU,{to:"/signin",children:"sign in"})]})]})]});var e=w;return this.state.quotes.length&&(e=this.state.quotes.map((function(e,n){return(0,Z.jsxs)("div",{children:[(0,Z.jsxs)(d.Z,{children:[(0,Z.jsx)(d.Z.Body,{children:(0,Z.jsxs)("blockquote",{className:"blockquote mb-0",children:[(0,Z.jsxs)("p",{children:[" ",e.body," "]}),(0,Z.jsxs)("footer",{className:"blockquote-footer",children:["Someone famous in ",(0,Z.jsx)("cite",{title:"Source Title",children:e.author})]})]})}),(0,Z.jsx)(d.Z.Footer,{children:(0,Z.jsx)(d.Z.Text,{children:(0,Z.jsx)(p.Z,{onSubmit:function(n){return t.postQuoteComment(e.postId,n)},children:(0,Z.jsxs)(p.Z.Row,{className:"align-items-center",children:[(0,Z.jsxs)(m.Z,{Col:!0,xs:7,children:[(0,Z.jsx)(p.Z.Label,{htmlFor:"inlineFormInput",srOnly:!0,children:"Comment"}),(0,Z.jsx)(p.Z.Control,{className:"mb-2",id:"inlineFormInput",placeholder:"Comment...",value:t.getIniitalComment(e.postId),onChange:function(n){return t.setQuoteComment(e.postId,n)}})]}),(0,Z.jsxs)(m.Z,{xs:"auto",children:[(0,Z.jsx)(x.Z,{type:"submit",variant:"dark",className:"mb-2",size:"sm",children:"Post"}),(0,Z.jsx)(g.rU,{to:"/"+e.postId,children:(0,Z.jsx)("div",{className:"link-params",children:"Open"})})]})]})})})})]}),(0,Z.jsx)("br",{}),(0,Z.jsx)("br",{})]},e.postId)}))),(0,Z.jsx)(v.Z,{isLoggedIn:this.state.isLoggedIn,children:(0,Z.jsxs)("div",{className:"quotes-input",children:[(0,Z.jsx)(m.Z,{md:{span:6,offset:3},children:(0,Z.jsxs)(d.Z.Body,{children:[(0,Z.jsxs)(d.Z.Title,{children:[(0,Z.jsx)("p",{children:"Quotes goes here"}),(0,Z.jsx)("span",{role:"img","aria-label":"pointing_down",children:" \ud83d\udc47 "})]}),(0,Z.jsx)(d.Z.Text,{children:(0,Z.jsxs)(p.Z,{onSubmit:this.postQuote,children:[(0,Z.jsxs)(p.Z.Group,{controlId:"author",children:[(0,Z.jsx)(p.Z.Label,{children:" Author: "}),(0,Z.jsx)(p.Z.Control,{type:"text",value:this.state.newQuote.author,onChange:this.setNewQuote})]}),(0,Z.jsxs)(p.Z.Group,{controlId:"body",children:[(0,Z.jsx)(p.Z.Label,{children:"Quote:"}),(0,Z.jsx)(p.Z.Control,{as:"textarea",rows:3,value:this.state.newQuote.body,onChange:this.setNewQuote})]}),(0,Z.jsx)(p.Z.Group,{children:(0,Z.jsx)(x.Z,{type:"submit",variant:"dark",size:"sm",children:"Post"})})]})})]})}),(0,Z.jsx)(f.Z,{children:e})]})})}}]),n}(h.Component)},3847:function(t,e,n){n.d(e,{Z:function(){return v}});var s=n(8152),o=n(2791),r=(n(7632),n(613),n(6144),n(5427)),i=n(5671),u=n(3144),a=n(136),c=n(8557),l=n(9005),h=n(7022),d=n(4034),f=n(1523),p=n(184),m=(0,u.Z)((function t(e,n){(0,i.Z)(this,t),this.text="",this.link="",this.text=e,this.link=n})),x=function(t){(0,a.Z)(n,t);var e=(0,c.Z)(n);function n(t){var s;return(0,i.Z)(this,n),(s=e.call(this,t)).state={items:[]},s}return(0,u.Z)(n,[{key:"render",value:function(){return(0,p.jsx)("div",{children:(0,p.jsx)(l.Z,{bg:"light",variant:"light",fixed:"top",children:(0,p.jsxs)(h.Z,{children:[(0,p.jsx)(l.Z.Brand,{children:"QR"}),(0,p.jsx)(d.Z,{className:"mr-auto",children:(0,p.jsx)(f.UT,{children:this.props.items.map((function(t){return(0,p.jsx)(f.rU,{to:t.link,children:t.text})}))})})]})})})}}]),n}(o.Component),g=function(t){(0,a.Z)(n,t);var e=(0,c.Z)(n);function n(t){var s;return(0,i.Z)(this,n),(s=e.call(this,t)).state={role:""},s}return(0,u.Z)(n,[{key:"render",value:function(){var t=[];switch(this.props.role){case"visitor":t=this.visitorMenuItems();break;case"allowed":t=this.userMenuItems()}return(0,p.jsx)(x,{items:t})}},{key:"visitorMenuItems",value:function(){return[new m("Home","/"),new m("Sign In","/signin"),new m("Register","/register")]}},{key:"userMenuItems",value:function(){return[new m("Quotes","/quotes"),new m("Sign Out","/signout")]}}]),n}(o.Component),j={position:"fixed",left:0,bottom:0,width:"100%",zIndex:9999,margin:0,textAlign:"center"},v=function(t){var e=(0,o.useState)(!1),n=(0,s.Z)(e,2),i=n[0],u=n[1];(0,o.useEffect)((function(){var t=function(){window.isOffline=!1,u(!1)},e=function(){window.isOffline=!0,u(!0)};return window.addEventListener("online",t),window.addEventListener("offline",e),function(){window.removeEventListener("online",t),window.removeEventListener("offline",e)}})),(0,o.useEffect)((function(){window.isOffline&&u(!0)}),[]);var a,c,l=(a=t.isLoggedIn,c=t.showBackButton,(0,p.jsx)(g,{role:a?"allowed":"visitor",showBackButton:c}));return(0,p.jsxs)("div",{children:[l,i?(0,p.jsx)(r.Z,{variant:"warning",style:j,children:"Offline mode"}):null,(0,p.jsx)("br",{}),t.children]})}}}]);
//# sourceMappingURL=493.7182b53b.chunk.js.map